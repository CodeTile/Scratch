@rendermode InteractiveServer
@namespace DonutChartSolution.Components.Shared
@inject NavigationManager Navigation

<div class="donut-chart-container">

    <svg class="donut-chart-svg"
         width="@Width"
         height="@Height"
         viewBox="0 0 200 220"
         @onmouseleave="ClearHover">

        @if (!string.IsNullOrWhiteSpace(Title))
        {
            <g>
                <text x="100"
                      y="20"
                      text-anchor="middle"
                      class="donut-title">
                    @Title
                </text>
            </g>
        }

        <!-- Shift entire chart down by 20px -->
        <g transform="translate(0, 20)">

            <g class="donut-slices">
                @foreach (var slice in Slices)
                {
                    <path d="@slice.PathData"
                          fill="@slice.Color"
                          class="donut-slice"
                          @onclick="() => OnSliceClick(slice)"
                          @onmouseover="() => OnSliceHover(slice)">
                    </path>
                }
            </g>

            @if (IsDonut)
            {
                <g class="donut-center"
                   @onclick="OnCenterClick"
                   @onmouseover="OnCenterHover">

                    <circle cx="100"
                            cy="100"
                            r="@InnerRadius"
                            class="donut-center-circle" />

                    @if (!string.IsNullOrWhiteSpace(InnerTitle))
                    {
                        <g>
                            <text x="100"
                                  y="95"
                                  text-anchor="middle"
                                  class="donut-inner-title">
                                @InnerTitle
                            </text>
                        </g>
                    }

                    <g>
                        <text x="100"
                              y="115"
                              text-anchor="middle"
                              class="donut-inner-text">
                            @TotalValue.ToString("N0")
                        </text>
                    </g>
                </g>
            }
        </g>
    </svg>

    @if (ShowTooltip)
    {
        <div class="donut-tooltip">
            <div class="donut-tooltip-title">@TooltipLabel</div>
            <div class="donut-tooltip-value">@TooltipValue</div>
        </div>
    }
</div>
